import json

class Studieplan:
    def __init__(self, plan_id, tittel):
        self.plan_id = plan_id      # unik id for studieplan
        self.tittel = tittel        # tittel på studieprogrammet
        # 6 semestre: 1, 2, 3, 4, 5, 6
        self.semestre = {i: [] for i in range(1, 7)}  # hver liste inneholder emnekoder

    def __str__(self):
        return f"{self.kode} - {self.navn} ({self.semester}, {self.studiepoeng} sp)"

class Studieplan:
    def __init__(self, plan_id, tittel):
        self.plan_id = plan_id      # unik id for studieplan
        self.tittel = tittel        # tittel på studieprogrammet
        # 6 semestre: 1, 2, 3, 4, 5, 6
        self.semestre = {i: [] for i in range(1, 7)}  # hver liste inneholder emnekoder

    def legg_til_emne(self, emne, semester):
        # sjekk at semester er gyldig for emnet
        if emne.semester == 'H' and semester not in [1, 3, 5]:
            print("Feil: Høstemner kan bare legges i 1., 3. eller 5. semester.")
            return
        if emne.semester == 'V' and semester not in [2, 4, 6]:
            print("Feil: Våremner kan bare legges i 2., 4. eller 6. semester.")
            return

        # sjekk om emnet allerede er lagt til
        for sem in self.semestre.values():
            if emne.kode in sem:
                print("Dette emnet er allerede i studieplanen.")
                return

        # sjekk at det er plass (maks 30 studiepoeng)
        total_sp = sum(e.studiepoeng for e in emner if e.kode in self.semestre[semester])
        if total_sp + emne.studiepoeng > 30:
            print("Feil: For mange studiepoeng i dette semesteret (maks 30).")
            return

        # legg til emne
        self.semestre[semester].append(emne.kode)
        print(f"Emnet {emne.kode} ble lagt til i semester {semester}.")

    def fjern_emne(self, emnekode):
        for sem, emneliste in self.semestre.items():
            if emnekode in emneliste:
                emneliste.remove(emnekode)
                print(f"Emnet {emnekode} ble fjernet fra semester {sem}.")
                return
        print("Emnet finnes ikke i denne studieplanen.")

    def er_gyldig(self):
        gyldig = True
        for sem, emnekoder in self.semestre.items():
            total_sp = sum(e.studiepoeng for e in emner if e.kode in emnekoder)
            if total_sp != 30:
                print(f"Semester {sem} har {total_sp} studiepoeng (bør være 30).")
                gyldig = False
        return gyldig

    def __str__(self):
        tekst = f"\nStudieplan: {self.tittel} (ID: {self.plan_id})\n"
        for sem, emnekoder in self.semestre.items():
            tekst += f"Semester {sem}:\n"
            for kode in emnekoder:
                emne = next((e for e in emner if e.kode == kode), None)
                if emne:
                    tekst += f"  - {emne}\n"
            if not emnekoder:
                tekst += "  (Ingen emner)\n"
        return tekst
